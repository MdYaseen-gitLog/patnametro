<!DOCTYPE html>
<html>
<head>
  <title>Metro Update</title>
</head>
<body>
  <h1>Update Metro Routes</h1>

  <label>Color:
    <input type="text" id="color" value="red">
  </label>
  <label>ROUTE_ID:
    <input type="text" id="route_id" value="RED">
  </label>
  <button id="load">Load Records</button>

  <div id="records"></div>

  <script>
    const API = "https://metroroutewrk.yaseenmd965.workers.dev";

    document.getElementById("load").addEventListener("click", async () => {
      const color = document.getElementById("color").value;
      const route_id = document.getElementById("route_id").value;

      const res = await fetch(`${API}/api/routes?color=${color}&route_id=${route_id}`);
      const data = await res.json();

      const container = document.getElementById("records");
      container.innerHTML = "";

      data.forEach(r => {
        const div = document.createElement("div");
        div.innerHTML = `
          <b>ID:</b> ${r.route_id} 
          <b>Color:</b> <input value="${r.color}" id="color_${r.route_id}">
          <b>Travel Time:</b> <input type="number" value="${r.travel_time}" id="time_${r.route_id}">
          <button onclick="update('${r.route_id}')">Update</button>
        `;
        container.appendChild(div);
      });
    });

    async function update(id) {
      const newColor = document.getElementById(`color_${id}`).value;
      const newTravelTime = Number(document.getElementById(`time_${id}`).value);

      await fetch(`${API}/api/routes/update`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id, newColor, newTravelTime })
      });

      alert("Updated!");
    }
  </script>
</body>
</html>
